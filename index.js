const { Telegraf } = require("telegraf")
const express = require('express')

const telegramToken = process.env.TELEGRAM_TOKEN || "YOUR_TELEGRAM_BOT_TOKEN"
const bot = new Telegraf(telegramToken)
const app = express()
const PORT = process.env.PORT || 3000

// ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð±Ð¾Ñ‚Ð°
let isBotActive = false

// Ð£Ð»ÑƒÑ‡ÑˆÐµÐ½Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾ÑÑ‚Ð¾Ð¹ Ð˜Ð˜
function simpleAI(message) {
    const text = message.toLowerCase().trim()
    
    // ÐŸÑ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ñ
    if (text.includes('Ð¿Ñ€Ð¸Ð²ÐµÑ‚') || text.includes('hello') || text.includes('hi') || text.includes('Ð·Ð´Ñ€Ð°Ð²ÑÑ‚Ð²ÑƒÐ¹')) 
        return "ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐžÑ‡ÐµÐ½ÑŒ Ñ€Ð°Ð´ Ð²Ð°Ñ Ð²Ð¸Ð´ÐµÑ‚ÑŒ! ðŸ˜Š Ð§ÐµÐ¼ Ð¼Ð¾Ð³Ñƒ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ?"
    
    if (text.includes('Ð´Ð¾Ð±Ñ€Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ') || text.includes('Ð´Ð¾Ð±Ñ€Ð¾Ðµ ÑƒÑ‚Ñ€Ð¾') || text.includes('Ð´Ð¾Ð±Ñ€Ñ‹Ð¹ Ð²ÐµÑ‡ÐµÑ€'))
        return "Ð˜ Ð²Ð°Ð¼ Ð´Ð¾Ð±Ñ€Ð¾Ð³Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ ÑÑƒÑ‚Ð¾Ðº! ðŸŒž ÐšÐ°Ðº Ð²Ð°ÑˆÐ¸ Ð´ÐµÐ»Ð°?"
    
    // Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¾ Ð´ÐµÐ»Ð°Ñ…
    if (text.includes('ÐºÐ°Ðº Ð´ÐµÐ»Ð°') || text.includes('how are you') || text.includes('ÐºÐ°Ðº Ñ‚Ñ‹'))
        return "Ð£ Ð¼ÐµÐ½Ñ Ð²ÑÑ‘ Ð¿Ñ€ÐµÐºÑ€Ð°ÑÐ½Ð¾! Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾, Ñ‡Ñ‚Ð¾ ÑÐ¿Ñ€Ð¾ÑÐ¸Ð»Ð¸! ðŸ‘ Ð ÐºÐ°Ðº Ð²Ð°ÑˆÐ¸ Ð´ÐµÐ»Ð°?"
    
    if (text.includes('Ñ‡Ñ‚Ð¾ Ð´ÐµÐ»Ð°ÐµÑˆÑŒ') || text.includes('what are you doing'))
        return "ÐžÑ‚Ð²ÐµÑ‡Ð°ÑŽ Ð½Ð° Ð²Ð°ÑˆÐ¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¸ ÑÑ‚Ð°Ñ€Ð°ÑŽÑÑŒ Ð±Ñ‹Ñ‚ÑŒ Ð¿Ð¾Ð»ÐµÐ·Ð½Ñ‹Ð¼! ðŸ’»"
    
    // Ð‘Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ð½Ð¾ÑÑ‚Ð¸
    if (text.includes('ÑÐ¿Ð°ÑÐ¸Ð±Ð¾') || text.includes('thank you') || text.includes('thanks') || text.includes('Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€ÑŽ'))
        return "Ð’ÑÐµÐ³Ð´Ð° Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°! Ð Ð°Ð´ Ð±Ñ‹Ð» Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ! ðŸ™"
    
    // ÐŸÑ€Ð¾Ñ‰Ð°Ð½Ð¸Ñ
    if (text.includes('Ð¿Ð¾ÐºÐ°') || text.includes('bye') || text.includes('Ð´Ð¾ ÑÐ²Ð¸Ð´Ð°Ð½Ð¸Ñ') || text.includes('goodbye'))
        return "Ð”Ð¾ ÑÐ²Ð¸Ð´Ð°Ð½Ð¸Ñ! Ð–Ð´Ñƒ Ð²Ð°ÑˆÐµÐ³Ð¾ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ! ðŸ‘‹ Ð‘Ñ‹Ð»Ð¾ Ð¿Ñ€Ð¸ÑÑ‚Ð½Ð¾ Ð¿Ð¾Ð¾Ð±Ñ‰Ð°Ñ‚ÑŒÑÑ!"
    
    // Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¾ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑÑ…
    if (text.includes('Ñ‡Ñ‚Ð¾ Ñ‚Ñ‹ ÑƒÐ¼ÐµÐµÑˆÑŒ') || text.includes('what can you do') || text.includes('Ñ‚Ð²Ð¾Ð¸ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸'))
        return "Ð¯ Ð¼Ð¾Ð³Ñƒ: Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ñ‚ÑŒ Ð½Ð° Ð¿Ñ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ñ, Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾ÑÑ‚Ð¾Ð¹ Ð´Ð¸Ð°Ð»Ð¾Ð³, Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ñ‚ÑŒ Ð½Ð° Ð±Ð°Ð·Ð¾Ð²Ñ‹Ðµ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹! ðŸ¤–"
    
    if (text.includes('ÐºÑ‚Ð¾ Ñ‚Ñ‹') || text.includes('who are you'))
        return "Ð¯ Ð’Ð¸Ñ‚Ð°Ð»Ñ-Ð±Ð¾Ñ‚! ÐŸÐ¾Ð¼Ð¾Ð³Ð°ÑŽ Ñ Ð±Ð°Ð·Ð¾Ð²Ñ‹Ð¼Ð¸ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°Ð¼Ð¸. ðŸ¤–"
    
    // Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
    if (text.includes('ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ñ‡Ð°Ñ') || text.includes('ÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸') || text.includes('time')) {
        const now = new Date()
        return `Ð¡ÐµÐ¹Ñ‡Ð°Ñ ${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')} â°`
    }
    
    if (text.includes('ÐºÐ°ÐºÐ¾Ð¹ Ð´ÐµÐ½ÑŒ') || text.includes('Ð´Ð°Ñ‚Ð°') || text.includes('date')) {
        const now = new Date()
        return `Ð¡ÐµÐ³Ð¾Ð´Ð½Ñ ${now.toLocaleDateString('ru-RU')} ðŸ“…`
    }
    
    // ÐŸÑ€Ð¾ÑÑ‚Ñ‹Ðµ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹
    if (text.includes('ÐºÐ°Ðº Ð¿Ð¾Ð³Ð¾Ð´Ð°') || text.includes('Ð¿Ð¾Ð³Ð¾Ð´Ð°'))
        return "Ðš ÑÐ¾Ð¶Ð°Ð»ÐµÐ½Ð¸ÑŽ, Ñ Ð½Ðµ Ð¼Ð¾Ð³Ñƒ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒÑÑ Ðº ÑÐµÑ€Ð²Ð¸ÑÑƒ Ð¿Ð¾Ð³Ð¾Ð´Ñ‹. ÐÐ¾ Ð½Ð°Ð´ÐµÑŽÑÑŒ, Ñ‡Ñ‚Ð¾ Ñƒ Ð²Ð°Ñ Ñ…Ð¾Ñ€Ð¾ÑˆÐ°Ñ Ð¿Ð¾Ð³Ð¾Ð´Ð°! â˜€ï¸"
    
    if (text.includes('ÐºÐ°Ðº Ð¶Ð¸Ð·Ð½ÑŒ') || text.includes('how is life'))
        return "Ð–Ð¸Ð·Ð½ÑŒ Ð¿Ñ€ÐµÐºÑ€Ð°ÑÐ½Ð°! ÐžÑÐ¾Ð±ÐµÐ½Ð½Ð¾ ÐºÐ¾Ð³Ð´Ð° Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ð¾Ð¼Ð¾Ð³Ð°Ñ‚ÑŒ Ñ‚Ð°ÐºÐ¸Ð¼ Ð·Ð°Ð¼ÐµÑ‡Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¼ Ð»ÑŽÐ´ÑÐ¼ ÐºÐ°Ðº Ð²Ñ‹! ðŸ˜Š"
    
    if (text.includes('ÑˆÑƒÑ‚ÐºÐ°') || text.includes('Ð°Ð½ÐµÐºÐ´Ð¾Ñ‚') || text.includes('joke')) {
        const jokes = [
            "ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð¸ÑÑ‚Ñ‹ Ñ‚Ð°Ðº Ð»ÑŽÐ±ÑÑ‚ Ð¿Ñ€Ð¸Ñ€Ð¾Ð´Ñƒ? ÐŸÐ¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ Ð² Ð½ÐµÐ¹ Ð½ÐµÑ‚ Ð±Ð°Ð³Ð¾Ð²! ðŸ˜„",
            "Ð§Ñ‚Ð¾ ÑÐºÐ°Ð·Ð°Ð» Ð¾Ð´Ð¸Ð½ Ð±Ð°Ð¹Ñ‚ Ð´Ñ€ÑƒÐ³Ð¾Ð¼Ñƒ? - Ð¯ Ñ‚ÐµÐ±Ñ Ð±Ð¸Ñ‚Ð°Ñ‚ÑŒ Ð±ÑƒÐ´Ñƒ! ðŸ˜†",
            "ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ ÐºÐ¾Ð¼Ð¿ÑŒÑŽÑ‚ÐµÑ€ Ñ‚Ð°Ðº Ñ…Ð¾Ð»Ð¾Ð´ÐµÐ½? - ÐŸÐ¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ Ñƒ Ð½ÐµÐ³Ð¾ Windows! â„ï¸",
            "ÐšÐ°Ðº Ð½Ð°Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¾Ð±ÐµÐ·ÑŒÑÐ½Ð°, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ñ…Ð¾Ñ‡ÐµÑ‚ ÑÑ‚Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð¸ÑÑ‚Ð¾Ð¼? - ÐšÐ¾Ð´ÐµÑ€-Ð¸Ð»Ð»Ð°! ðŸµ"
        ]
        return jokes[Math.floor(Math.random() * jokes.length)]
    }
    
    // ÐœÐ°Ñ‚ÐµÐ¼Ð°Ñ‚Ð¸ÐºÐ°
    if (text.includes('ÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð±ÑƒÐ´ÐµÑ‚') && text.match(/\d+[\+\-\*\/]\d+/)) {
        try {
            const match = text.match(/(\d+)([\+\-\*\/])(\d+)/)
            const a = parseInt(match[1])
            const b = parseInt(match[3])
            const op = match[2]
            
            let result
            if (op === '+') result = a + b
            else if (op === '-') result = a - b
            else if (op === '*') result = a * b
            else if (op === '/') result = b !== 0 ? a / b : 'Ð½Ð° Ð½Ð¾Ð»ÑŒ Ð´ÐµÐ»Ð¸Ñ‚ÑŒ Ð½ÐµÐ»ÑŒÐ·Ñ!'
            
            return `Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: ${a} ${op} ${b} = ${result} ðŸ§®`
        } catch (e) {
            return "ÐÐµ Ð¼Ð¾Ð³Ñƒ Ð²Ñ‹Ñ‡Ð¸ÑÐ»Ð¸Ñ‚ÑŒ ÑÑ‚Ð¾ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ ðŸ˜”"
        }
    }
    
    // Ð¡Ð»ÑƒÑ‡Ð°Ð¹Ð½Ñ‹Ðµ Ð¾Ñ‚Ð²ÐµÑ‚Ñ‹ Ð´Ð»Ñ Ð½ÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ñ… Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð²
    const randomAnswers = [
        "Ð˜Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ñ‹Ð¹ Ð²Ð¾Ð¿Ñ€Ð¾Ñ! Ð”Ð°Ð¹Ñ‚Ðµ Ð¼Ð½Ðµ Ð¿Ð¾Ð´ÑƒÐ¼Ð°Ñ‚ÑŒ... ðŸ¤”",
        "Ð¥Ð¼, Ð¼Ð½Ðµ Ð½ÑƒÐ¶Ð½Ð¾ Ð½ÐµÐ¼Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð´ÑƒÐ¼Ð°Ñ‚ÑŒ Ð½Ð°Ð´ ÑÑ‚Ð¸Ð¼... ðŸ’­",
        "Ð˜Ð·Ð²Ð¸Ð½Ð¸Ñ‚Ðµ, Ñ ÐµÑ‰Ðµ ÑƒÑ‡ÑƒÑÑŒ. ÐœÐ¾Ð¶ÐµÑ‚Ðµ Ð·Ð°Ð´Ð°Ñ‚ÑŒ Ð±Ð¾Ð»ÐµÐµ Ð¿Ñ€Ð¾ÑÑ‚Ð¾Ð¹ Ð²Ð¾Ð¿Ñ€Ð¾Ñ? ðŸ“š",
        "ÐŸÐ¾ÐºÐ° Ð¼Ð¾Ð¸ Ð·Ð½Ð°Ð½Ð¸Ñ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ñ‹, Ð½Ð¾ Ñ ÑÑ‚Ð°Ñ€Ð°ÑŽÑÑŒ Ñ€Ð°Ð·Ð²Ð¸Ð²Ð°Ñ‚ÑŒÑÑ! ðŸš€",
        "ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ Ð²Ð¾Ð¿Ñ€Ð¾Ñ! Ðš ÑÐ¾Ð¶Ð°Ð»ÐµÐ½Ð¸ÑŽ, Ñ Ð¿Ð¾ÐºÐ° Ð½Ðµ Ð¼Ð¾Ð³Ñƒ Ð½Ð° Ð½ÐµÐ³Ð¾ Ð¾Ñ‚Ð²ÐµÑ‚Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð»Ð½Ð¾Ñ†ÐµÐ½Ð½Ð¾. ðŸ˜”",
        "ÐœÐ¾Ð¶ÐµÑ‚, ÑÐ¿Ñ€Ð¾ÑÐ¸Ñ‚Ðµ Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ Ð´Ñ€ÑƒÐ³Ð¾Ðµ? Ð¯ Ð»ÑƒÑ‡ÑˆÐµ Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÑŽ Ð½Ð° Ð¿Ñ€Ð¾ÑÑ‚Ñ‹Ðµ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹! ðŸ˜Š"
    ]
    
    return randomAnswers[Math.floor(Math.random() * randomAnswers.length)]
}

// Ð¤Ñ€Ð°Ð·Ñ‹ Ð´Ð»Ñ Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ
const wakeUpPhrases = [
    "Ð“ÑƒÐ´ÐµÐ½Ñ‚Ð°Ðº! ðŸ˜Ž Ð’Ð¸Ñ‚Ð°Ð»Ñ Ð½Ð° ÑÐ²ÑÐ·Ð¸!",
    "Ð’Ð¸Ñ‚Ð°Ð»Ñ Ð² Ð·Ð´Ð°Ð½Ð¸Ð¸! ðŸ’ª Ð§ÐµÐ¼ Ð¼Ð¾Ð³Ñƒ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ?",
    "ÐŸÑ€Ð¾ÑÐ½ÑƒÐ»ÑÑ! ðŸš€ Ð“Ð¾Ñ‚Ð¾Ð² Ðº Ñ€Ð°Ð±Ð¾Ñ‚Ðµ!",
    "Ð’Ð¸Ñ‚Ð°Ð»Ñ Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½! âš¡ Ð§Ñ‚Ð¾ Ñƒ Ð½Ð°Ñ Ñ‚Ð°Ð¼?",
    "ÐžÐ¿Ð°-Ð½Ð°! ðŸ˜ Ð’Ð¸Ñ‚Ð°Ð»Ñ Ð½Ð° Ð¿Ñ€Ð¾Ð²Ð¾Ð´Ðµ!"
]

// Ð¤Ñ€Ð°Ð·Ñ‹ Ð´Ð»Ñ Ð²Ñ‹ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ
const sleepPhrases = [
    "ÐÐ¹ Ð¼Ð»Ñ! ÐœÐ°ÑÐ»Ð¸Ð½Ñƒ Ð¿Ð¾Ð¹Ð¼Ð°Ð»! ðŸ˜µâ€ðŸ’« Ð’Ñ‹Ñ€ÑƒÐ±Ð°ÑŽÑÑŒ...",
    "Ð’Ð¸Ñ‚Ð°Ð»Ñ ÑƒÑ…Ð¾Ð´Ð¸Ñ‚ Ð² Ð·Ð°ÐºÐ°Ñ‚! ðŸŒ… Ð”Ð¾ ÑÐ²ÑÐ·Ð¸!",
    "ÐžÑ‚ÐºÐ»ÑŽÑ‡Ð°ÑŽÑÑŒ! ðŸ”Œ Ð‘Ñ‹Ð»Ð¾ Ð¿Ñ€Ð¸ÑÑ‚Ð½Ð¾ Ð¿Ð¾Ð±Ð¾Ð»Ñ‚Ð°Ñ‚ÑŒ!",
    "Ð’Ð¸Ñ‚Ð°Ð»Ñ Ð½Ð° Ð¿Ð¾ÐºÐ¾Ð¹! ðŸ˜´ Ð¡Ð¿Ð¾ÐºÐ¾Ð¹Ð½Ð¾Ð¹ Ð²ÑÐµÐ¼!",
    "ÐÐ¹ ÑÐ¹ ÑÐ¹! ðŸ«£ ÐŸÐ¾Ñ€Ð° Ð¾Ñ‚Ð´Ð¾Ñ…Ð½ÑƒÑ‚ÑŒ..."
]

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ Ð² Ð³Ñ€ÑƒÐ¿Ð¿Ðµ
bot.on("text", async (ctx) => {
    const messageText = ctx.message.text.toLowerCase()
    
    // ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð±Ð¾Ñ‚Ð°
    if (messageText.includes('Ð²Ð¸Ñ‚Ð°Ð»Ñ Ð¿Ñ€Ð¾ÑÐ½Ð¸ÑÑŒ') || messageText.includes('Ð²Ð¸Ñ‚Ð°Ð»Ñ Ð²ÐºÐ»ÑŽÑ‡Ð¸ÑÑŒ')) {
        if (!isBotActive) {
            isBotActive = true
            const phrase = wakeUpPhrases[Math.floor(Math.random() * wakeUpPhrases.length)]
            await ctx.reply(phrase)
        } else {
            await ctx.reply("Ð¯ ÑƒÐ¶Ðµ Ð² ÑÑ‚Ñ€Ð¾ÑŽ! ðŸ’ª")
        }
        return
    }
    
    // ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° Ð²Ñ‹ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð±Ð¾Ñ‚Ð°
    if (messageText.includes('Ð²Ð¸Ñ‚Ð°Ð»Ñ ÑƒÐ¹Ð´Ð¸') || messageText.includes('Ð²Ð¸Ñ‚Ð°Ð»Ñ Ð²Ñ‹Ñ€ÑƒÐ±Ð°Ð¹') || messageText.includes('Ð²Ð¸Ñ‚Ð°Ð»Ñ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡Ð¸ÑÑŒ')) {
        if (isBotActive) {
            isBotActive = false
            const phrase = sleepPhrases[Math.floor(Math.random() * sleepPhrases.length)]
            await ctx.reply(phrase)
        } else {
            await ctx.reply("Ð¯ Ð¸ Ñ‚Ð°Ðº Ð¾Ñ‚Ð´Ñ‹Ñ…Ð°ÑŽ... ðŸ˜´")
        }
        return
    }
    
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑ‚Ð°Ñ‚ÑƒÑÐ° Ð±Ð¾Ñ‚Ð°
    if (messageText.includes('Ð²Ð¸Ñ‚Ð°Ð»Ñ Ñ‚Ñ‹ Ð·Ð´ÐµÑÑŒ') || messageText.includes('Ð²Ð¸Ñ‚Ð°Ð»Ñ ÑÑ‚Ð°Ñ‚ÑƒÑ')) {
        await ctx.reply(isBotActive ? "ÐÐ° Ð¼ÐµÑÑ‚Ðµ! ðŸ’ª Ð“Ð¾Ñ‚Ð¾Ð² Ðº Ñ€Ð°Ð±Ð¾Ñ‚Ðµ!" : "Ð¡Ð¿Ð»ÑŽ... ðŸ˜´ Ð Ð°Ð·Ð±ÑƒÐ´Ð¸Ñ‚Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð¾Ð¹ 'Ð’Ð¸Ñ‚Ð°Ð»Ñ Ð¿Ñ€Ð¾ÑÐ½Ð¸ÑÑŒ'")
        return
    }
    
    // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ (Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ Ð±Ð¾Ñ‚ Ð°ÐºÑ‚Ð¸Ð²ÐµÐ½)
    if (isBotActive && messageText.startsWith('Ð²Ð¸Ñ‚Ð°Ð»Ñ')) {
        console.log(`ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ð’Ð¸Ñ‚Ð°Ð»Ð¸: ${ctx.message.text}`)
        
        // Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ "Ð²Ð¸Ñ‚Ð°Ð»Ñ" Ð¸Ð· ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸
        const cleanMessage = ctx.message.text.slice(7).trim()
        
        if (cleanMessage === '') {
            await ctx.reply("Ð”Ð°, Ñ Ð·Ð´ÐµÑÑŒ! ðŸ˜Š Ð§ÐµÐ¼ Ð¼Ð¾Ð³Ñƒ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ?")
        } else {
            const response = simpleAI(cleanMessage)
            await ctx.reply(response)
        }
    }
})

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ /start
bot.start((ctx) => {
    ctx.reply("ÐŸÑ€Ð¸Ð²ÐµÑ‚! ðŸ‘‹ Ð¯ Ð’Ð¸Ñ‚Ð°Ð»Ñ-Ð±Ð¾Ñ‚. Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð¼ÐµÐ½Ñ Ð² Ð³Ñ€ÑƒÐ¿Ð¿Ñƒ Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹:\n\n" +
             "â€¢ 'Ð’Ð¸Ñ‚Ð°Ð»Ñ Ð¿Ñ€Ð¾ÑÐ½Ð¸ÑÑŒ' - Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð±Ð¾Ñ‚Ð°\n" +
             "â€¢ 'Ð’Ð¸Ñ‚Ð°Ð»Ñ ÑƒÐ¹Ð´Ð¸' - Ð´ÐµÐ°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð±Ð¾Ñ‚Ð°\n" +
             "â€¢ 'Ð’Ð¸Ñ‚Ð°Ð»Ñ [Ð²Ð¾Ð¿Ñ€Ð¾Ñ]' - Ð·Ð°Ð´Ð°Ñ‚ÑŒ Ð²Ð¾Ð¿Ñ€Ð¾Ñ (ÐºÐ¾Ð³Ð´Ð° Ð°ÐºÑ‚Ð¸Ð²ÐµÐ½)")
})

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ /help
bot.help((ctx) => {
    ctx.reply("ÐšÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð´Ð»Ñ Ð³Ñ€ÑƒÐ¿Ð¿Ñ‹:\n\n" +
             "ðŸš€ ÐÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ: 'Ð’Ð¸Ñ‚Ð°Ð»Ñ Ð¿Ñ€Ð¾ÑÐ½Ð¸ÑÑŒ'\n" +
             "ðŸ”Œ Ð”ÐµÐ°ÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ: 'Ð’Ð¸Ñ‚Ð°Ð»Ñ ÑƒÐ¹Ð´Ð¸'\n" +
             "â“ ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ°: 'Ð’Ð¸Ñ‚Ð°Ð»Ñ Ñ‚Ñ‹ Ð·Ð´ÐµÑÑŒ?'\n" +
             "ðŸ’¬ ÐžÐ±Ñ‰ÐµÐ½Ð¸Ðµ: 'Ð’Ð¸Ñ‚Ð°Ð»Ñ [Ð²Ð°Ñˆ Ð²Ð¾Ð¿Ñ€Ð¾Ñ]'")
})

// Express Ð´Ð»Ñ Ñ…Ð¾ÑÑ‚Ð¸Ð½Ð³Ð°
app.get('/', (req, res) => {
    res.send('ðŸ¤– Ð’Ð¸Ñ‚Ð°Ð»Ñ-Ð±Ð¾Ñ‚ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð½Ð° Heroku!')
})

app.listen(PORT, () => {
    console.log(`ðŸš€ Ð¡ÐµÑ€Ð²ÐµÑ€ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð½Ð° Ð¿Ð¾Ñ€Ñ‚Ñƒ ${PORT}`)
})

// Ð—Ð°Ð¿ÑƒÑÐº Ð±Ð¾Ñ‚Ð°
bot.launch().then(() => {
    console.log("ðŸ¤– Ð’Ð¸Ñ‚Ð°Ð»Ñ-Ð±Ð¾Ñ‚ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð½Ð° Heroku!")
}).catch((error) => {
    console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð¿ÑƒÑÐºÐ° Ð±Ð¾Ñ‚Ð°:", error)
})

// ÐšÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹
process.once('SIGINT', () => bot.stop('SIGINT'))
process.once('SIGTERM', () => bot.stop('SIGTERM'))